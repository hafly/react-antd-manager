(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{1159:function(e,t,a){"use strict";a.r(t),a.d(t,"default",function(){return _});a(365);var n=a(366),i=a.n(n),r=(a(95),a(94)),l=a.n(r),o=(a(321),a(322)),s=a.n(o),c=(a(344),a(345)),d=a.n(c),u=(a(153),a(65)),m=a.n(u),p=a(9),h=a(10),f=a(12),b=a(11),y=a(13),w=(a(347),a(348)),k=a.n(w),E=a(0),v=a.n(E),O=a(388),g=a(93),S=a.n(g),I=a(96),j=a(97),x=k.a.Item,_=function(e){function t(){var e,a;Object(p.a)(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(a=Object(f.a)(this,(e=Object(b.a)(t)).call.apply(e,[this].concat(i)))).state={orderConfirmVisible:!1,selectedRowKeys:[],selectedRows:{},orderInfo:{}},a.params={page:1,city:"",order_time:"",order_status:""},a.formList=[{type:"Select",label:"\u57ce\u5e02",field:"city",width:100,placeholder:"\u5168\u90e8",initialValue:"0",list:[{id:"0",name:"\u5168\u90e8"},{id:"1",name:"\u5317\u4eac\u5e02"},{id:"2",name:"\u5929\u6d25\u5e02"},{id:"3",name:"\u91cd\u5e86\u5e02"}]},{type:"RangePicker",label:"\u8ba2\u5355\u65f6\u95f4",field:"order_time",initialValue:[S()("2019-09-01","YYYY-MM-DD"),S()("2019-09-30","YYYY-MM-DD")]},{type:"Select",label:"\u8ba2\u5355\u72b6\u6001",field:"order_status",width:100,initialValue:"1",list:[{id:"0",name:"\u5168\u90e8"},{id:"1",name:"\u8fdb\u884c\u4e2d"},{id:"2",name:"\u7ed3\u675f\u884c\u7a0b"}]}],a.columns=[{title:"\u8ba2\u5355\u7f16\u53f7",dataIndex:"order_sn"},{title:"\u8f66\u8f86\u7f16\u53f7",dataIndex:"bike_sn"},{title:"\u7528\u6237\u540d",dataIndex:"user_name"},{title:"\u624b\u673a\u53f7\u7801",dataIndex:"mobile"},{title:"\u91cc\u7a0b",dataIndex:"distance",render:function(e){return e/1e3+"Km"}},{title:"\u884c\u9a76\u65f6\u957f",dataIndex:"total_time"},{title:"\u72b6\u6001",dataIndex:"status"},{title:"\u5f00\u59cb\u65f6\u95f4",dataIndex:"start_time"},{title:"\u7ed3\u675f\u65f6\u95f4",dataIndex:"end_time"},{title:"\u8ba2\u5355\u91d1\u989d",dataIndex:"total_fee"},{title:"\u5b9e\u4ed8\u91d1\u989d",dataIndex:"user_pay"}],a.handleFormSubmit=function(e){a.params=e,a.params.page=1,a.requestList()},a.showModelFinishOrder=function(){var e=a.state.selectedRows.id;e?I.a.ajax({url:"/order/ebike_info",data:{id:e}}).then(function(e){a.setState({orderConfirmVisible:!0,orderInfo:e.data})}):m.a.warn({title:"\u4fe1\u606f",content:"\u8bf7\u9009\u62e9\u4e00\u6761\u8ba2\u5355\u8fdb\u884c\u64cd\u4f5c"})},a.showModelFinishOrderOk=function(){I.a.ajax({url:"/order/finish_order",data:{id:1}}).then(function(){d.a.success("\u8ba2\u5355\u7ed3\u675f\u6210\u529f"),a.setState({orderConfirmVisible:!1,selectedRows:{},selectedRowKeys:[]}),a.requestList()})},a.onRowSelect=function(e){a.setState({selectedRowKeys:[e.key],selectedRows:e})},a.openOrderDetail=function(){var e=a.state.selectedRows;e.id?window.open("/common/order/detail/".concat(e.id)):m.a.warn({title:"\u4fe1\u606f",content:"\u8bf7\u9009\u62e9\u4e00\u6761\u8ba2\u5355\u8fdb\u884c\u64cd\u4f5c"})},a}return Object(y.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){this.requestList()}},{key:"requestList",value:function(){var e=this,t=this;I.a.ajax({url:"/order/list",data:{page:this.params}}).then(function(a){var n=a.data;n.rows.map(function(e,t){return e.key=t}),e.setState({dataSource:n.rows,pagination:j.a.pagination(n,function(e){t.params.page=e,t.requestList()})})})}},{key:"render",value:function(){var e=this,t={labelCol:{span:5},wrapperCol:{span:19}};return v.a.createElement("div",null,v.a.createElement(s.a,null,v.a.createElement(O.a,{formList:this.formList,formSubmit:this.handleFormSubmit})),v.a.createElement(s.a,{style:{marginTop:10,borderBottom:0}},v.a.createElement(l.a,{onClick:this.openOrderDetail},"\u8ba2\u5355\u8be6\u60c5"),v.a.createElement(l.a,{style:{marginLeft:10},onClick:this.showModelFinishOrder},"\u7ed3\u675f\u8ba2\u5355")),v.a.createElement(s.a,null,v.a.createElement(i.a,{bordered:!0,columns:this.columns,dataSource:this.state.dataSource,rowSelection:{type:"radio",selectedRowKeys:this.state.selectedRowKeys,onSelect:function(t){e.onRowSelect(t)}},pagination:this.state.pagination})),v.a.createElement(m.a,{title:"\u7ed3\u675f\u8ba2\u5355",visible:this.state.orderConfirmVisible,onCancel:function(){e.setState({orderConfirmVisible:!1})},onOk:this.showModelFinishOrderOk},v.a.createElement(k.a,{layout:"horizontal"},v.a.createElement(x,Object.assign({label:"\u8f66\u8f86\u4fe1\u606f"},t),this.state.orderInfo.bike_sn),v.a.createElement(x,Object.assign({label:"\u5269\u4f59\u7535\u91cf"},t),this.state.orderInfo.battery+"%"),v.a.createElement(x,Object.assign({label:"\u884c\u7a0b\u5f00\u59cb\u65f6\u95f4"},t),this.state.orderInfo.start_time),v.a.createElement(x,Object.assign({label:"\u5f53\u524d\u4f4d\u7f6e"},t),this.state.orderInfo.location))))}}]),t}(v.a.Component)},388:function(e,t,a){"use strict";a(95);var n=a(94),i=a.n(n),r=(a(346),a(354)),l=a.n(r),o=a(9),s=a(10),c=a(12),d=a(11),u=a(13),m=(a(383),a(385)),p=a.n(m),h=(a(355),a(350)),f=a.n(h),b=(a(347),a(348)),y=a.n(b),w=a(0),k=a.n(w),E=y.a.Item,v=f.a.Option,O=p.a.RangePicker,g=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(a=Object(c.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(i)))).handleFormSubmit=function(){var e=a.props.form.getFieldsValue();a.props.formSubmit(e)},a.reset=function(){a.props.form.resetFields()},a}return Object(u.a)(t,e),Object(s.a)(t,[{key:"initFormList",value:function(){var e=this,t=this.props.form.getFieldDecorator,a=this.props.formList,n=[];return a&&a.length>0&&a.forEach(function(a){var i=a.field,r=a.label||"",o=a.initialValue||"",s=a.width||"auto";if("Input"===a.type){var c=k.a.createElement(E,{label:r,key:i},t(i,{initialValue:o})(k.a.createElement(l.a,{type:"text",placeholder:a.placeholder,style:{width:s}})));n.push(c)}else if("Select"===a.type){var d=k.a.createElement(E,{label:r,key:i},t(i,{initialValue:o})(k.a.createElement(f.a,{placeholder:a.placeholder,style:{width:s}},e.getOptionList(a.list))));n.push(d)}else if("DatePicker"===a.type){var u=k.a.createElement(E,{label:r,key:i},t(i,{initialValue:o||null})(k.a.createElement(p.a,{placeholder:a.placeholder,style:{width:s}})));n.push(u)}else if("RangePicker"===a.type){var m=k.a.createElement(E,{label:r,key:i},t(i,{initialValue:o||null})(k.a.createElement(O,{style:{width:s}})));n.push(m)}}),n}},{key:"getOptionList",value:function(e){return e.map(function(e){return k.a.createElement(v,{value:e.id,key:e.id},e.name)})}},{key:"render",value:function(){return k.a.createElement(y.a,{layout:"inline"},this.initFormList(),k.a.createElement(E,null,k.a.createElement(i.a,{type:"primary",style:{margin:"0 20px"},onClick:this.handleFormSubmit},"\u67e5\u8be2"),k.a.createElement(i.a,{onClick:this.reset},"\u91cd\u7f6e")))}}]),t}(k.a.Component);t.a=y.a.create()(g)}}]);